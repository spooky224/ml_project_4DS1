"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[8923],{9213:function(e,t,n){n.r(t),n.d(t,{RunPage:function(){return Ft},default:function(){return Lt}});var r=n(68248),o=n(74060),i=n(27757),s=n(56530),a=n(59930),l=n.n(a),d=n(46709),u=n(54401),c=n(91105),m=n(16389),g=n(44105),p=n(71206),h=n(43075),v=n(93846),f=n(73408);const y=({runTags:e,experimentId:t,runOutputs:n,artifactUri:o,runUuid:s})=>{const{theme:a}=(0,i.u)(),l=(0,v.Ub)(`(min-width: ${a.responsive.breakpoints.sm}px)`);return(0,f.Y)("div",{css:(0,r.AH)({flex:1,overflow:"hidden",display:"flex",paddingBottom:a.spacing.md,position:"relative"},""),children:(0,f.Y)(h.Ay,{runUuid:s,runTags:e,runOutputs:n,useAutoHeight:l,artifactRootUri:o,experimentId:t})})};var Y=n(40724),M=n(10536),x=n(60284);const _=()=>{const{"*":e}=(0,c.g)();return"model-metrics"===e?g.N3.MODEL_METRIC_CHARTS:"system-metrics"===e?g.N3.SYSTEM_METRIC_CHARTS:"evaluations"===e?g.N3.EVALUATIONS:"traces"===e?g.N3.TRACES:null!==e&&void 0!==e&&e.match(/^(artifactPath|artifacts)/)?g.N3.ARTIFACTS:g.N3.OVERVIEW},I=[g.N3.ARTIFACTS,g.N3.EVALUATIONS],A=()=>{const{experimentId:e,runUuid:t}=(0,c.g)(),n=(0,c.Zp)(),{theme:r}=(0,i.u)(),s=_(),[a,l]=(0,d.useState)(I.includes(s));return(0,f.FD)(o.LegacyTabs,{activeKey:s,onChange:r=>{e&&t&&s!==r&&(l(I.includes(r)),r!==g.N3.OVERVIEW?n(x.Ay.getRunPageTabRoute(e,t,r)):n(x.Ay.getRunPageRoute(e,t)))},tabBarStyle:{margin:a&&"0px"},children:[(0,f.Y)(o.LegacyTabs.TabPane,{tab:(0,f.Y)(Y.A,{id:"kA+QJr",defaultMessage:"Overview"})},g.N3.OVERVIEW),(0,f.Y)(o.LegacyTabs.TabPane,{tab:(0,f.Y)(Y.A,{id:"j25Ttg",defaultMessage:"Model metrics"})},g.N3.MODEL_METRIC_CHARTS),(0,f.Y)(o.LegacyTabs.TabPane,{tab:(0,f.Y)(Y.A,{id:"hFlaPP",defaultMessage:"System metrics"})},g.N3.SYSTEM_METRIC_CHARTS),(0,f.Y)(o.LegacyTabs.TabPane,{tab:(0,f.Y)(Y.A,{id:"s8a93+",defaultMessage:"Traces"})},g.N3.EVALUATIONS),(0,f.Y)(o.LegacyTabs.TabPane,{tab:(0,f.Y)(Y.A,{id:"vPqFJE",defaultMessage:"Artifacts"})},g.N3.ARTIFACTS)]})};var b=n(76118),T=n(43835),S=n(673),w=(n(27206),n(10165));var R={name:"s5xdrg",styles:"display:flex;align-items:center"},C={name:"2ecpu6",styles:"margin-left:8px;margin-right:4px"};function D({models:e,onRegisterClick:t,experimentId:n,runUuid:s}){const{theme:a}=(0,i.u)(),l=(e,l)=>(0,f.FD)(o.DropdownMenu.Group,{children:[(0,f.Y)(o.DropdownMenu.Label,{children:e}),l.map((e=>{const l=(0,b.first)(e.registeredModelVersionSummaries);if(!l)return(0,f.FD)(o.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_50",onClick:()=>t(e),children:[(0,f.Y)("div",{css:(0,r.AH)({marginRight:a.spacing.md},""),children:(0,b.last)(e.path.split("/"))}),(0,f.Y)(o.DropdownMenu.HintColumn,{children:(0,f.Y)(c.N_,{target:"_blank",to:x.Ay.getRunPageTabRoute(n,s,"artifacts/"+e.path),children:(0,f.Y)(i.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_58",type:"link",size:"small",onClick:e=>{e.stopPropagation()},endIcon:(0,f.Y)(i.au,{}),children:(0,f.Y)(Y.A,{id:"NqEELO",defaultMessage:"View model"})})})})]},e.absolutePath);const{status:d,displayedName:u,version:m,link:g}=l;return(0,f.Y)(c.N_,{target:"_blank",to:g,children:(0,f.FD)(o.DropdownMenu.Item,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_80",children:[(0,f.Y)(o.DropdownMenu.IconWrapper,{css:R,children:"READY"===d?(0,f.Y)(w.h,{}):d?S.UA[d]:null}),(0,f.FD)("span",{css:(0,r.AH)({marginRight:a.spacing.md},""),children:[u,(0,f.FD)(o.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_90",css:C,children:["v",m]})]}),(0,f.Y)(o.DropdownMenu.HintColumn,{children:(0,f.Y)(i.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_89",type:"link",size:"small",onClick:e=>{e.stopPropagation()},endIcon:(0,f.Y)(i.au,{}),children:(0,f.Y)(Y.A,{id:"T1sd79",defaultMessage:"Go to model"})})})]})},e.absolutePath)}))]}),d=e.filter((e=>e.registeredModelVersionSummaries.length>0)),u=e.filter((e=>!e.registeredModelVersionSummaries.length));return(0,f.FD)(f.FK,{children:[u.length?l("Unregistered models",u):null,u.length&&d.length?(0,f.Y)(o.DropdownMenu.Separator,{}):null,d.length?l("Registered models",d):null]})}const E=({runUuid:e,experimentId:t,runTags:n,artifactRootUri:s,registeredModelVersionSummaries:a})=>{const{theme:l}=(0,i.u)(),u=(0,d.useMemo)((()=>n?m.A.getLoggedModelsFromTags(n).map((({artifactPath:e})=>e)):[]),[n]),g=(0,d.useMemo)((()=>(0,b.orderBy)(u.map((e=>({path:e,absolutePath:`${s}/${e}`,registeredModelVersionSummaries:(null===a||void 0===a?void 0:a.filter((({source:t})=>t===`${s}/${e}`)))||[]}))),(e=>{var t;return parseInt((null===(t=e.registeredModelVersionSummaries[0])||void 0===t?void 0:t.version)||"0",10)}),"desc")),[u,a,s]),[p,h]=(0,d.useState)(null);if(g.length>1){const n=g.filter((e=>e.registeredModelVersionSummaries.length>0));return(0,f.FD)(f.FK,{children:[p&&(0,f.Y)(T.vR,{runUuid:e,modelPath:p.absolutePath,modelRelativePath:p.path,disabled:!1,showButton:!1,modalVisible:!0,onCloseModal:()=>h(null)}),(0,f.FD)(o.DropdownMenu.Root,{modal:!1,children:[(0,f.Y)(o.LegacyTooltip,{placement:"bottom",title:(0,f.Y)(Y.A,{id:"qE/ZB7",defaultMessage:"{registeredCount}/{loggedCount} logged models are registered",values:{registeredCount:n.length,loggedCount:g.length}}),children:(0,f.Y)(o.DropdownMenu.Trigger,{asChild:!0,children:(0,f.Y)(i.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_195",type:"primary",endIcon:(0,f.Y)(o.ChevronDownIcon,{}),children:(0,f.Y)(Y.A,{id:"WGN2f3",defaultMessage:"Register model"})})})}),(0,f.Y)(o.DropdownMenu.Content,{align:"end",children:(0,f.Y)(D,{models:g,onRegisterClick:h,experimentId:t,runUuid:e})})]})]})}const v=(0,b.first)(g);if(!v)return null;const y=(0,b.first)(v.registeredModelVersionSummaries);return y?(0,f.Y)(c.N_,{to:y.link,target:"_blank",css:(0,r.AH)({marginLeft:l.spacing.sm},""),children:(0,f.Y)(i.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewheaderregistermodelbutton.tsx_231",endIcon:(0,f.Y)(i.au,{}),type:"link",children:"Model registered"})}):(0,f.Y)(T.vR,{disabled:!1,runUuid:e,modelPath:v.absolutePath,modelRelativePath:v.path,showButton:!0,buttonType:"primary"})};var k=n(91944);var F={name:"ozd7xs",styles:"flex-shrink:0"};const L=({hasComparedExperimentsBefore:e,comparedExperimentIds:t=[],experiment:n,runDisplayName:r,runTags:o,runParams:i,runUuid:s,runOutputs:a,handleRenameRunClick:l,handleDeleteRunClick:u,artifactRootUri:m,registeredModelVersionSummaries:p,isLoading:h})=>{var v;const y=(0,d.useMemo)((()=>{var e,t;const r=(null===(e=n.tags)||void 0===e||null===(t=e.find((e=>e.key===k.kk)))||void 0===t?void 0:t.value)===g.Gk.GENAI_DEVELOPMENT,o=!(!a||!a.modelOutputs)&&a.modelOutputs.length>0;return r&&!o}),[n,a]),_=x.Ay.getExperimentPageTabRoute(null!==(v=n.experimentId)&&void 0!==v?v:"",y?g.fM.EvaluationRuns:g.fM.Runs);const I=[e&&t?(0,f.Y)(c.N_,{to:x.Ay.getCompareExperimentsPageRoute(t),children:(0,f.Y)(Y.A,{id:"LLm5Bo",defaultMessage:"Displaying Runs from {numExperiments} Experiments",values:{numExperiments:t.length}})}):(0,f.Y)(c.N_,{to:_,"data-testid":"experiment-runs-link",children:n.name})];n.experimentId&&I.push((0,f.Y)(c.N_,{to:_,"data-testid":"experiment-observatory-link-runs",children:y?(0,f.Y)(Y.A,{id:"/T979r",defaultMessage:"Evaluations"}):(0,f.Y)(Y.A,{id:"Rx8d9z",defaultMessage:"Runs"})}));return(0,f.FD)("div",{css:F,children:[(0,f.FD)(M.z,{title:(0,f.Y)("span",{"data-testid":"runs-header",children:r}),breadcrumbs:I,children:[(0,f.Y)(M.o,{menu:[{id:"overflow-rename-button",onClick:l,itemName:(0,f.Y)(Y.A,{id:"fv7vQf",defaultMessage:"Rename"})},...u?[{id:"overflow-delete-button",onClick:u,itemName:(0,f.Y)(Y.A,{id:"7WkP1e",defaultMessage:"Delete"})}]:[]]}),(()=>{var e;return(0,f.Y)(E,{runUuid:s,experimentId:null!==(e=null===n||void 0===n?void 0:n.experimentId)&&void 0!==e?e:"",runTags:o,artifactRootUri:m,registeredModelVersionSummaries:p})})()]}),(0,f.Y)(A,{})]})};var U=n(7655),N=n(79081),P=n(90142),B=n(31153);const O=({status:e})=>{const{theme:t}=(0,i.u)();return(0,f.FD)(o.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_overview_runviewstatusbox.tsx_81",css:(0,r.AH)({backgroundColor:"FINISHED"===e?t.isDarkMode?t.colors.green800:t.colors.green100:"KILLED"===e||"FAILED"===e?t.isDarkMode?t.colors.red800:t.colors.red100:"SCHEDULED"===e||"RUNNING"===e?t.isDarkMode?t.colors.blue800:t.colors.blue100:void 0},""),children:[e&&(0,f.Y)(B.F,{status:e})," ",(0,f.Y)(i.T.Text,{css:(0,r.AH)({marginLeft:t.spacing.sm},""),children:"FINISHED"===e?(0,f.Y)(i.T.Text,{color:"success",children:(0,f.Y)(Y.A,{id:"ujm55z",defaultMessage:"Finished"})}):"KILLED"===e?(0,f.Y)(i.T.Text,{color:"error",children:(0,f.Y)(Y.A,{id:"AupQl+",defaultMessage:"Killed"})}):"FAILED"===e?(0,f.Y)(i.T.Text,{color:"error",children:(0,f.Y)(Y.A,{id:"AM8DuO",defaultMessage:"Failed"})}):"RUNNING"===e?(0,f.Y)(i.T.Text,{color:"info",children:(0,f.Y)(Y.A,{id:"On3g1B",defaultMessage:"Running"})}):"SCHEDULED"===e?(0,f.Y)(i.T.Text,{color:"info",children:(0,f.Y)(Y.A,{id:"X8OaXU",defaultMessage:"Scheduled"})}):e})]})},H=({runInfo:e,tags:t})=>{var n;const r=m.A.getUser(e,t);return(0,f.Y)(c.N_,{to:x.Ay.searchRunsByUser(null!==(n=null===e||void 0===e?void 0:e.experimentId)&&void 0!==n?n:"",r),children:r})};var V=n(27461),z=n(66916),K=n(77680),$=n(55274),G=n(43617),q=n(90061),W=n(47207);const{systemMetricsLabel:j,modelMetricsLabel:Q}=(0,K.YK)({systemMetricsLabel:{id:"aFMLIO",defaultMessage:"System metrics"},modelMetricsLabel:{id:"NiSPrL",defaultMessage:"Model metrics"}}),X=e=>({key:t})=>t.toLowerCase().includes(e.toLowerCase()),J=({metricsList:e,runInfo:t,header:n,table:s})=>{var a,l;const{theme:d}=(0,i.u)(),[{column:u},...m]=s.getLeafHeaders(),p=null===(a=m.find((e=>"value"===e.id)))||void 0===a?void 0:a.column,h=e.some((({loggedModels:e})=>!(0,b.isEmpty)(e))),v=null===(l=m.find((e=>"models"===e.id)))||void 0===l?void 0:l.column;return e.length?(0,f.FD)(f.FK,{children:[n&&(0,f.Y)(o.TableRow,{children:(0,f.Y)(o.TableCell,{css:(0,r.AH)({flex:1,backgroundColor:d.colors.backgroundSecondary},""),children:(0,f.FD)(i.T.Text,{bold:!0,children:[n," (",e.length,")"]})})}),e.map((({key:e,value:n,loggedModels:i})=>{var s,a;return(0,f.FD)(o.TableRow,{children:[(0,f.Y)(o.TableCell,{style:{flex:u.getCanResize()?u.getSize()/100:void 0},children:(0,f.Y)(c.N_,{to:x.Ay.getRunPageTabRoute(null!==(s=t.experimentId)&&void 0!==s?s:"",null!==(a=t.runUuid)&&void 0!==a?a:"",g.N3.MODEL_METRIC_CHARTS),children:e})}),(0,f.Y)(o.TableCell,{css:(0,r.AH)({flex:null!==p&&void 0!==p&&p.getCanResize()?p.getSize()/100:void 0},""),children:n.toString()}),h&&(0,f.Y)(o.TableCell,{css:(0,r.AH)({flex:null!==v&&void 0!==v&&v.getCanResize()?v.getSize()/100:void 0},""),children:(0,b.isEmpty)(i)?"-":(0,f.Y)(o.Overflow,{children:null===i||void 0===i?void 0:i.map((e=>{var t,n,r,o,i,s;return(0,f.Y)(c.N_,{target:"_blank",rel:"noopener noreferrer",to:x.Ay.getExperimentLoggedModelDetailsPage(null!==(n=null===(r=e.info)||void 0===r?void 0:r.experiment_id)&&void 0!==n?n:"",null!==(o=null===(i=e.info)||void 0===i?void 0:i.model_id)&&void 0!==o?o:""),children:null===(s=e.info)||void 0===s?void 0:s.name},null===(t=e.info)||void 0===t?void 0:t.model_id)}))})})]},e)}))]}):null};var Z={name:"1gbhmpg",styles:"flex:0 0 auto;display:flex;flex-direction:column;overflow:hidden"},ee={name:"ozd7xs",styles:"flex-shrink:0"};const te=({latestMetrics:e,runInfo:t,loggedModels:n})=>{const{theme:s}=(0,i.u)(),{detailsPageTableStyles:a,detailsPageNoEntriesStyles:l}=(0,W.z)(),u=(0,U.A)(),[c,m]=(0,d.useState)(""),g=(0,d.useMemo)((()=>{if(!n)return{};const e=(0,b.compact)((0,b.flatMap)(n,(e=>{var t,n;return null===(t=e.data)||void 0===t||null===(n=t.metrics)||void 0===n?void 0:n.map((({key:t})=>({key:t,model:e})))}))),t=(0,b.groupBy)(e,"key");return(0,b.mapValues)(t,(e=>e.map((({model:e})=>e))))}),[n]),p=(0,d.useMemo)((()=>{const t=(0,b.values)(e);return(0,b.isEmpty)(g)?t:t.map((e=>{var t;return{...e,loggedModels:null!==(t=g[e.key])&&void 0!==t?t:[]}}))}),[e,g]),h=p.some((({loggedModels:e})=>!(0,b.isEmpty)(e))),v=(0,d.useMemo)((()=>[{id:"models",header:u.formatMessage({id:"mRshzt",defaultMessage:"Models"}),accessorKey:"models",enableResizing:!0}]),[u]),y=(0,d.useMemo)((()=>{const e=[{id:"key",accessorKey:"key",header:()=>(0,f.Y)(Y.A,{id:"pjlcSc",defaultMessage:"Metric"}),enableResizing:!0,size:240},{id:"value",header:()=>(0,f.Y)(Y.A,{id:"t0Qkuc",defaultMessage:"Value"}),accessorKey:"value",enableResizing:!0}];return h&&e.push(...v),e}),[h,v]),M=(0,d.useMemo)((()=>{const e=p.filter((({key:e})=>(0,$.bw)(e))),t=p.filter((({key:e})=>!(0,$.bw)(e)));return e.length>0&&t.length>0?[{header:u.formatMessage(j),metrics:e.filter(X(c))},{header:u.formatMessage(Q),metrics:t.filter(X(c))}]:[{header:void 0,metrics:p.filter(X(c))}]}),[c,p,u]),x=(0,G.N4)({data:p,getCoreRowModel:(0,q.HT)(),getRowId:e=>e.key,enableColumnResizing:!0,columnResizeMode:"onChange",columns:y});return(0,f.FD)("div",{css:Z,children:[(0,f.Y)(i.T.Title,{level:4,css:ee,children:(0,f.Y)(Y.A,{id:"m4159e",defaultMessage:"Metrics ({length})",values:{length:p.filter(X(c)).length}})}),(0,f.Y)("div",{css:(0,r.AH)({padding:s.spacing.sm,border:`1px solid ${s.colors.borderDecorative}`,borderRadius:s.general.borderRadiusBase,display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},""),children:(()=>{if(!p.length)return(0,f.Y)("div",{css:l,children:(0,f.Y)(o.Empty,{description:(0,f.Y)(Y.A,{id:"9vj5Ap",defaultMessage:"No metrics recorded"})})});const e=(0,b.sum)(M.map((({metrics:e})=>e.length)))<1;return(0,f.FD)(f.FK,{children:[(0,f.Y)("div",{css:(0,r.AH)({marginBottom:s.spacing.sm},""),children:(0,f.Y)(z.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_overview_runviewmetricstable.tsx_186",prefix:(0,f.Y)(z.S,{}),placeholder:u.formatMessage({id:"w2+rkp",defaultMessage:"Search metrics"}),value:c,onChange:e=>m(e.target.value),allowClear:!0})}),(0,f.FD)(o.Table,{scrollable:!0,empty:e?(0,f.Y)("div",{children:(0,f.Y)(o.Empty,{description:(0,f.Y)(Y.A,{id:"lT1Joh",defaultMessage:"No metrics match the search filter"})})}):null,css:a,children:[(0,f.Y)(o.TableRow,{isHeader:!0,children:x.getLeafHeaders().map((e=>(0,f.Y)(o.TableHeader,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_overview_runviewmetricstable.tsx_312",header:e,column:e.column,setColumnSizing:x.setColumnSizing,isResizing:e.column.getIsResizing(),style:{flex:e.column.getCanResize()?e.column.getSize()/100:void 0},children:(0,G.Kv)(e.column.columnDef.header,e.getContext())},e.id)))}),M.map(((e,n)=>(0,f.Y)(J,{metricsList:e.metrics,runInfo:t,header:e.header,table:x},e.header||n)))]})]})})()})]})};var ne=n(39606),re=n(48292);var oe=n(5690),ie=n(31655),se=n(99002);const ae=({parentRunUuid:e})=>{const t=(0,s.wA)(),n=(0,s.d4)((({entities:t})=>t.runInfosByUuid[e])),r=(0,se.t)({runUuid:e,disabled:!(0,ie.wD)()}),i=(0,d.useMemo)((()=>{var e;return(0,ie.wD)()?null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.info:n}),[r,n]);return(0,d.useEffect)((()=>{(0,ie.wD)()||i||t((0,oe.aO)(e))}),[t,e,i]),i?i.experimentId&&i.runUuid?(0,f.Y)(c.N_,{to:x.Ay.getRunPageRoute(i.experimentId,i.runUuid),children:i.runName}):null:(0,f.Y)(o.ParagraphSkeleton,{loading:!0,label:(0,f.Y)(Y.A,{id:"nfIS4i",defaultMessage:"Parent run name loading"})})};var le=n(27042),de=n(24712),ue=n(59281),ce=n(181);var me={name:"1wcfv52",styles:"margin-right:0"};const ge=({runUuid:e,tags:t,onTagsUpdated:n})=>{const a=(0,ie.V0)(),[l,u]=(0,d.useState)(!1),{theme:c}=(0,i.u)(),m=(0,s.wA)(),g=(0,U.A)(),[p,h]=(0,d.useMemo)((()=>[(0,b.keys)(t).filter(ce.oD),(0,b.values)(t).filter((({key:e})=>(0,ce.oD)(e)))]),[t]),v=h.map((({key:e,value:t})=>({key:e,value:t}))),{TagAssignmentModal:y,showTagAssignmentModal:M}=(0,de.S)({componentIdPrefix:"mlflow.run-view-tags-box",initialTags:v,isLoading:l,onSubmit:(t,n)=>(u(!0),m((0,oe.cj)(e,t,n)).then((()=>{u(!1)}))),onSuccess:n}),{EditTagsModal:x,showEditTagsModal:_,isLoading:I}=(0,le.Q)({valueRequired:!0,allAvailableTags:p,saveTagsHandler:async(t,r,o)=>m((0,oe.hD)(e,r,o)).then(n)}),A=()=>{a?M():_({tags:h})},T=g.formatMessage({id:"EwAZgg",defaultMessage:"Edit tags"});return(0,f.FD)("div",{css:(0,r.AH)({paddingTop:c.spacing.xs,paddingBottom:c.spacing.xs,display:"flex",flexWrap:"wrap",alignItems:"center","> *":{marginRight:"0 !important"},gap:c.spacing.xs},""),children:[v.length<1?(0,f.Y)(i.B,{componentId:"mlflow.run_details.overview.tags.add_button",size:"small",type:"tertiary",onClick:A,children:(0,f.Y)(Y.A,{id:"dt3hj5",defaultMessage:"Add tags"})}):(0,f.FD)(f.FK,{children:[v.map((e=>(0,f.Y)(ue.t,{tag:e,enableFullViewModal:!0,css:me},`${e.key}-${e.value}`))),(0,f.Y)(N.T,{componentId:"mlflow.run_details.overview.tags.edit_button.tooltip",content:T,children:(0,f.Y)(i.B,{componentId:"mlflow.run_details.overview.tags.edit_button","aria-label":T,size:"small",icon:(0,f.Y)(o.PencilIcon,{}),onClick:A})})]}),I&&(0,f.Y)(i.S,{size:"small"}),x,y]})};var pe=n(52644),he=n(53935);const ve=({runUuid:e,tags:t,onDescriptionChanged:n})=>{var a;const l=(null===(a=t[he.e])||void 0===a?void 0:a.value)||"",[u,c]=(0,d.useState)(!1),m=(0,U.A)(),{theme:g}=(0,i.u)(),p=(0,s.wA)(),h=!l;return(0,f.FD)("div",{css:(0,r.AH)({marginBottom:g.spacing.md},""),children:[(0,f.FD)(i.T.Title,{level:4,css:(0,r.AH)({display:"flex",alignItems:"center",gap:g.spacing.xs},""),children:[(0,f.Y)(Y.A,{id:"ugwpKL",defaultMessage:"Description"}),(0,f.Y)(i.B,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_overview_runviewdescriptionbox.tsx_46",size:"small",type:"tertiary","aria-label":m.formatMessage({id:"Mtj9Ay",defaultMessage:"Edit description"}),onClick:()=>c(!0),icon:(0,f.Y)(o.PencilIcon,{})})]}),h&&!u&&(0,f.Y)(i.T.Hint,{children:(0,f.Y)(Y.A,{id:"VcNdOq",defaultMessage:"No description"})}),(!h||u)&&(0,f.Y)(pe.V,{defaultMarkdown:l,onSubmit:t=>p((0,oe.Jv)(e,he.e,t)).then(n).then((()=>c(!1))),onCancel:()=>c(!1),showEditor:u})]})};n(69603);var fe={name:"e0dnmk",styles:"cursor:pointer"};const ye=({registeredModelVersionSummaries:e})=>{const{theme:t}=(0,i.u)();return(0,f.Y)(o.Overflow,{children:null===e||void 0===e?void 0:e.map((e=>(0,f.FD)(c.N_,{to:e.link,css:(0,r.AH)({display:"flex",alignItems:"center",gap:t.spacing.sm},""),children:[(0,f.Y)(w.h,{})," ",e.displayedName," ",(0,f.FD)(o.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_overview_runviewregisteredmodelsbox.tsx_40",css:fe,children:["v",e.version]})]},e.displayedName)))})};var Ye=n(49708),Me=n(59795);const xe=async({queryKey:e})=>{const[,{runUuid:t}]=e;return Me.M.getPromptVersionsForRun(t)};var _e=n(6050);var Ie={name:"1bmnxg7",styles:"white-space:nowrap"};const Ae=({tags:e,runUuid:t})=>{const{theme:n}=(0,i.u)(),{data:s,error:a,isLoading:l}=(({runUuid:e},t={})=>{var n;const r=(0,Ye.I)(["run_uuid",{runUuid:e}],{queryFn:xe,retry:!1,...t});return{data:r.data,error:null!==(n=r.error)&&void 0!==n?n:void 0,isLoading:r.isLoading,refetch:r.refetch}})({runUuid:t}),d=[...(null===s||void 0===s?void 0:s.model_versions)||[],...(0,_e.U7)(e)];return l?(0,f.Y)(o.ParagraphSkeleton,{}):a||!d||0===d.length?(0,f.Y)(i.T.Hint,{css:(0,r.AH)({padding:`${n.spacing.xs}px 0px`},""),children:"\u2014"}):(0,f.Y)("div",{css:(0,r.AH)({display:"flex",flexDirection:"row",gap:n.spacing.sm,flexWrap:"wrap",padding:`${n.spacing.xs}px 0px`},""),children:d.map(((e,t)=>{const n=x.Ay.getPromptDetailsPageRoute(encodeURIComponent(e.name)),r=`${e.name} (v${e.version})`;return(0,f.FD)(i.T.Text,{css:Ie,children:[(0,f.Y)(c.N_,{to:n,children:r}),t<d.length-1&&","]},r)}))})},be=({loggedModels:e,loggedModelsV3:t,runInfo:n})=>{const{theme:s}=(0,i.u)(),{experimentId:a,runUuid:l}=n,u=e=>(0,b.first)(e)||(0,f.Y)(Y.A,{id:"0HbGko",defaultMessage:"Model"}),m=(0,d.useMemo)((()=>{const t=e.map((e=>u(e.flavors)));return new Set(t).size!==t.length}),[e]);return(0,f.FD)(o.Overflow,{children:[e.map(((e,t)=>(0,f.FD)(c.N_,{to:x.Ay.getRunPageRoute(null!==a&&void 0!==a?a:"",null!==l&&void 0!==l?l:"",e.artifactPath),css:(0,r.AH)({display:"flex",alignItems:"center",gap:s.spacing.sm,cursor:"pointer",height:m&&t>0?s.general.heightBase:s.general.heightSm},""),children:[(0,f.Y)(o.ModelsIcon,{}),(0,f.FD)("div",{children:[u(e.flavors),m&&t>0&&(0,f.Y)(i.T.Hint,{children:e.artifactPath})]})]},e.artifactPath))),t.map(((e,t)=>{var n,i,l,d,u;return(0,f.FD)(c.N_,{to:x.Ay.getExperimentLoggedModelDetailsPageRoute(null!==a&&void 0!==a?a:"",null!==(n=null===(i=e.info)||void 0===i?void 0:i.model_id)&&void 0!==n?n:""),css:(0,r.AH)({display:"flex",alignItems:"center",gap:s.spacing.sm,cursor:"pointer",height:m&&t>0?s.general.heightBase:s.general.heightSm},""),children:[(0,f.Y)(o.ModelsIcon,{}),(0,f.Y)("div",{children:null===(u=e.info)||void 0===u?void 0:u.name})]},null!==(l=null===(d=e.info)||void 0===d?void 0:d.model_id)&&void 0!==l?l:t)}))]})};var Te=n(91701),Se=n(42762);var we={name:"1wcfv52",styles:"margin-right:0"},Re={name:"kauk44",styles:"display:flex;gap:4px;white-space:nowrap"},Ce={name:"1a7v7i3",styles:"margin-right:0;&>div{padding-right:0;}"};const De=({runUuid:e,tags:t,search:n,className:s})=>{var a,l,d;const u=null===t||void 0===t||null===(a=t[g.xd])||void 0===a?void 0:a.value,c=null===t||void 0===t||null===(l=t[m.A.gitCommitTag])||void 0===l?void 0:l.value,p=m.A.renderSource(t,n,e,u),{theme:h}=(0,i.u)();return p?(0,f.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:h.spacing.sm,paddingTop:h.spacing.sm,paddingBottom:h.spacing.sm,flexWrap:"wrap"},""),className:s,children:[(0,f.Y)(Se.m,{sourceType:null===(d=t[m.A.sourceTypeTag])||void 0===d?void 0:d.value,css:(0,r.AH)({color:h.colors.actionPrimaryBackgroundDefault},"")}),p," ",u&&(0,f.Y)(o.LegacyTooltip,{title:u,children:(0,f.Y)(o.Tag,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_overview_runviewsourcebox.tsx_48",css:we,children:(0,f.FD)("div",{css:Re,children:[(0,f.Y)(o.BranchIcon,{})," ",u]})})}),c&&(0,f.FD)(i.aw.Root,{componentId:"mlflow.run_details.overview.source.commit_hash_popover",children:[(0,f.Y)(i.aw.Trigger,{asChild:!0,children:(0,f.Y)(o.Tag,{componentId:"mlflow.run_details.overview.source.commit_hash",css:Ce,children:(0,f.FD)("div",{css:(0,r.AH)({display:"flex",gap:h.spacing.xs,whiteSpace:"nowrap",alignContent:"center"},""),children:[(0,f.Y)(o.GitCommitIcon,{}),c.slice(0,7)]})})}),(0,f.FD)(i.aw.Content,{align:"start",children:[(0,f.Y)(i.aw.Arrow,{}),(0,f.FD)("div",{css:(0,r.AH)({display:"flex",gap:h.spacing.xs,alignItems:"center"},""),children:[c,(0,f.Y)(Te.i,{showLabel:!1,size:"small",type:"tertiary",copyText:c,icon:(0,f.Y)(o.CopyIcon,{})})]})]})]})]}):(0,f.Y)(i.T.Hint,{children:"\u2014"})};n(48107);var Ee=n(20980),ke=n(88185);var Fe=n(9230),Le=n(6619),Ue=n(75173),Ne=n(59863);const Pe=[Le.I7.RelationshipType,Le.I7.Step,Le.I7.Name,Le.I7.Status,Le.I7.CreationTime,Le.I7.RegisteredModels,Le.I7.Dataset];var Be={name:"xt6tct",styles:"flex:1;display:flex;flex-direction:column;overflow:hidden"},Oe={name:"g030ms",styles:"display:flex;flex-direction:row;justify-content:space-between;align-items:center"},He={name:"ozd7xs",styles:"flex-shrink:0"};const Ve=({inputs:e,outputs:t,runInfo:n,loggedModelsV3:s,isLoadingLoggedModels:a=!1,loggedModelsError:l})=>{const{theme:u}=(0,i.u)(),{models:c}=((e,t,n,r)=>{const o=(0,d.useMemo)((()=>{var t;return(0,b.compact)((0,b.uniq)(null===e||void 0===e||null===(t=e.modelInputs)||void 0===t?void 0:t.map((e=>e.modelId)))).map((e=>{const t=null===r||void 0===r?void 0:r.find((t=>{var n;return(null===(n=t.info)||void 0===n?void 0:n.model_id)===e}));if(t)return{...t,direction:"input"}}))}),[null===e||void 0===e?void 0:e.modelInputs,r]),i=(0,d.useMemo)((()=>{var e;return(0,b.compact)((0,b.uniq)(null===t||void 0===t||null===(e=t.modelOutputs)||void 0===e?void 0:e.map((e=>e.modelId)))).map((e=>{var n,o;const i=null===r||void 0===r?void 0:r.find((t=>{var n;return(null===(n=t.info)||void 0===n?void 0:n.model_id)===e})),s=null===t||void 0===t||null===(n=t.modelOutputs)||void 0===n?void 0:n.find((({modelId:e})=>{var t;return e===(null===i||void 0===i||null===(t=i.info)||void 0===t?void 0:t.model_id)}));if(i)return{...i,direction:"output",step:null!==(o=null===s||void 0===s?void 0:s.step)&&void 0!==o?o:void 0}}))}),[null===t||void 0===t?void 0:t.modelOutputs,r]);return{models:(0,d.useMemo)((()=>{var e,t;return null!==(e=(0,b.uniqBy)((0,b.compact)([...o,...i]).map((t=null===n||void 0===n?void 0:n.runUuid,e=>{var n;return null!==(n=e.data)&&void 0!==n&&n.metrics?{...e,data:{...e.data,metrics:e.data.metrics.filter((e=>!t||e.run_id===t))}}:e})),(e=>{var t;return null===(t=e.info)||void 0===t?void 0:t.model_id})))&&void 0!==e?e:[]}),[o,i,n])}})(e,t,n,s),[m,g]=(0,d.useState)({}),{columnDefs:p}=(0,Le.ih)({loggedModels:c,columnVisibility:m,disablePinnedColumns:!0,disableOrderBy:!0,supportedAttributeColumnKeys:Pe});return(0,f.FD)("div",{css:Be,children:[(0,f.FD)("div",{css:Oe,children:[(0,f.Y)(i.T.Title,{level:4,css:He,children:(0,f.Y)(Y.A,{id:"km8vtM",defaultMessage:"Logged models ({length})",values:{length:c.length}})}),(0,f.Y)(Ne.$,{columnDefs:p,onUpdateColumns:g,columnVisibility:m,customTrigger:(0,f.Y)(i.B,{componentId:"mlflow.logged_model.list.columns",icon:(0,f.Y)(o.ColumnsIcon,{})})})]}),(0,f.Y)(N.S,{size:"sm",shrinks:!1}),(0,f.FD)("div",{css:(0,r.AH)({padding:u.spacing.sm,border:`1px solid ${u.colors.border}`,borderRadius:u.general.borderRadiusBase,display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},""),children:[l instanceof Error&&l.message&&(0,f.FD)(f.FK,{children:[(0,f.Y)(o.Alert,{type:"error",description:l.message,message:(0,f.Y)(Y.A,{id:"2BzYqp",defaultMessage:"Error loading logged models"}),closable:!1,componentId:"mlflow.run_page.logged_model.list.error"}),(0,f.Y)(N.S,{size:"sm",shrinks:!1})]}),(0,f.Y)(Ue.Xs,{children:(0,f.Y)(Fe._,{columnDefs:p,loggedModels:c,columnVisibility:m,isLoading:a,isLoadingMore:!1,moreResultsAvailable:!1,disableLoadMore:!0,css:ze(u),displayShowExampleButton:!1})})]})]})},ze=e=>({"&.ag-theme-balham":{"--ag-border-color":e.colors.border,"--ag-row-border-color":e.colors.border,"--ag-foreground-color":e.colors.textPrimary,"--ag-background-color":"transparent","--ag-odd-row-background-color":"transparent","--ag-row-hover-color":e.colors.actionDefaultBackgroundHover,"--ag-selected-row-background-color":e.colors.actionDefaultBackgroundPress,"--ag-header-foreground-color":e.colors.textPrimary,"--ag-header-background-color":e.colors.backgroundPrimary,"--ag-modal-overlay-background-color":e.colors.overlayOverlay,".ag-header-row.ag-header-row-column-group":{"--ag-header-foreground-color":e.colors.textPrimary},borderTop:0,fontSize:e.typography.fontSizeBase,".ag-center-cols-viewport":{...(0,i.A)(e,{orientation:"horizontal"})}}});var Ke=n(23158),$e=n(21678),Ge=n(12803);var qe={name:"1bmnxg7",styles:"white-space:nowrap"};const We=({runUuid:e,experimentId:t})=>{const{theme:n}=(0,i.u)(),s=(0,U.A)(),[a,l]=(0,d.useState)(),[u,m]=(0,d.useState)(),[g,p]=(0,d.useState)(!1),[h,v]=(0,d.useState)(!1),y=(0,d.useCallback)((async n=>{p(!0);try{var r;const o=await Ge.x.searchRuns({experiment_ids:[t],filter:`tags.\`${P.Ol}\` = '${e}'`,order_by:["attributes.start_time DESC"],max_results:10,page_token:n}),i=(null===(r=o.runs)||void 0===r?void 0:r.map((e=>e.info)))||[];l(((e=[])=>[...e,...i])),m(o.next_page_token),v(!1)}catch{v(!0)}finally{p(!1)}}),[t,e]);if((0,d.useEffect)((()=>{l(void 0),m(void 0),y()}),[y]),void 0!==a&&0===a.length)return null;return(0,f.Y)($e.wB,{keyValue:s.formatMessage({id:"HXbUkt",defaultMessage:"Child runs"}),value:h?(0,f.Y)(i.T.Text,{color:"error",children:(0,f.Y)(Y.A,{id:"k0m460",defaultMessage:"Failed to load child runs"})}):void 0===a?(0,f.Y)(o.ParagraphSkeleton,{loading:!0,label:(0,f.Y)(Y.A,{id:"A6c78D",defaultMessage:"Child runs loading"})}):(0,f.FD)("div",{children:[(0,f.Y)("div",{css:(0,r.AH)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:n.spacing.sm,padding:`${n.spacing.sm}px 0`},""),children:a.map(((e,t)=>(0,f.FD)(i.T.Text,{css:qe,children:[(0,f.Y)(c.N_,{to:x.Ay.getRunPageRoute(e.experimentId,e.runUuid),children:e.runName}),t<a.length-1&&","]},e.runUuid)))}),u&&(0,f.Y)("div",{css:(0,r.AH)({marginBottom:n.spacing.sm},""),children:(0,f.Y)(i.B,{componentId:"mlflow.run_details.overview.child_runs.load_more_button",size:"small",onClick:()=>y(u),loading:g,children:(0,f.Y)(Y.A,{id:"wtpLvY",defaultMessage:"Load more"})})})]})})};var je={name:"ti75j2",styles:"margin:0"};const Qe=({tags:e,runInfo:t,datasets:n})=>{const[s,a]=(0,d.useState)(null),[l,u]=(0,d.useState)(!1),{theme:c}=(0,i.u)();if(!n||!n.length)return null;return(0,f.FD)(f.FK,{children:[(0,f.Y)(o.Overflow,{children:n.map((o=>(0,f.Y)(i.T.Link,{componentId:"mlflow.run_details.datasets_box.dataset_link",css:(0,r.AH)({textAlign:"left",".anticon":{fontSize:c.general.iconFontSize}},""),onClick:()=>(r=>{var o,i,s;a({datasetWithTags:r,runData:{experimentId:null!==(o=t.experimentId)&&void 0!==o?o:void 0,runUuid:null!==(i=t.runUuid)&&void 0!==i?i:"",runName:null!==(s=t.runName)&&void 0!==s?s:void 0,datasets:n,tags:e}}),u(!0)})(o),children:(0,f.Y)(ne.E,{datasetWithTags:o,displayTextAsLink:!0,css:je})})))}),s&&(0,f.Y)(re.O,{isOpen:l,setIsOpen:u,selectedDatasetWithRun:s,setSelectedDatasetWithRun:a})]})};var Xe=function(e){return e.DETAILS="DETAILS",e.DATASETS="DATASETS",e.TAGS="TAGS",e.REGISTERED_MODELS="REGISTERED_MODELS",e}(Xe||{});var Je={name:"67z2yy",styles:"flex:1;align-self:flex-start"},Ze={name:"1ctdo4k",styles:"min-height:360px;max-height:760px;overflow:hidden;display:flex"},et={name:"1jf67h2",styles:"height:500px"};const tt=({runUuid:e,onRunDataUpdated:t,tags:n,runInfo:o,datasets:s,params:a,latestMetrics:l,runInputs:u,runOutputs:p,registeredModelVersionSummaries:h,loggedModelsV3:v=[],isLoadingLoggedModels:y=!1,loggedModelsError:Y,experimentKind:M})=>{const{theme:_}=(0,i.u)(),{search:I}=(0,c.zy)(),A=((0,U.A)(),(0,d.useMemo)((()=>m.A.getLoggedModelsFromTags(n)),[n])),T=(n[P.Ol],!(0,b.isEmpty)(null===u||void 0===u?void 0:u.modelInputs)||!(0,b.isEmpty)(null===p||void 0===p?void 0:p.modelOutputs)),S=!T,{modelVersions:w}=(g.Gk.GENAI_DEVELOPMENT,(null===A||void 0===A?void 0:A.length)>0||(null===v||void 0===v||v.length),(0,Ee.b)({loggedModels:v})),R=(0,b.uniqBy)([...h,...w],(e=>null===e||void 0===e?void 0:e.link)),C=(({runUuid:e,runInfo:t,tags:n,onTagsUpdated:o,datasets:s,shouldRenderLoggedModelsBox:a,loggedModelsV3:l,registeredModelVersionSummaries:u})=>{var g,p,h;const v=(0,U.A)(),{theme:y}=(0,i.u)(),{search:Y}=(0,c.zy)(),M=(0,d.useMemo)((()=>m.A.getLoggedModelsFromTags(n)),[n]),_=n[P.Ol],I=t&&(0,f.FD)(f.FK,{children:[(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"PP5HZf",defaultMessage:"Created at"}),value:t.startTime?m.A.formatTimestamp(t.startTime,v):(0,f.Y)($e.bw,{})}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"7KKvmS",defaultMessage:"Created by"}),value:(0,f.Y)(H,{runInfo:t,tags:n})}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"ffema5",defaultMessage:"Experiment ID"}),value:(0,f.Y)(ke.t,{value:null!==(g=null===t||void 0===t?void 0:t.experimentId)&&void 0!==g?g:"",element:null!==t&&void 0!==t&&t.experimentId?(0,f.Y)(c.N_,{to:x.Ay.getExperimentPageRoute(t.experimentId),children:null===t||void 0===t?void 0:t.experimentId}):void 0})}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"vxY1CI",defaultMessage:"Status"}),value:(0,f.Y)(O,{status:t.status})}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"JYVQuV",defaultMessage:"Run ID"}),value:(0,f.Y)(ke.t,{value:null!==(p=t.runUuid)&&void 0!==p?p:""})}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"ZoIjun",defaultMessage:"Duration"}),value:m.A.getDuration(t.startTime,t.endTime)}),_&&(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"zdYXP8",defaultMessage:"Parent run"}),value:(0,f.Y)(ae,{parentRunUuid:_.value})}),(0,f.Y)(We,{runUuid:e,experimentId:t.experimentId}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"WmDiY9",defaultMessage:"Source"}),value:(0,f.Y)(De,{tags:n,search:Y,runUuid:e,css:(0,r.AH)({paddingTop:y.spacing.xs,paddingBottom:y.spacing.xs},"")})}),a&&(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"mjNFJt",defaultMessage:"Logged models"}),value:(0,f.Y)(be,{runInfo:t,loggedModels:M,loggedModelsV3:l})}),(0,f.Y)($e.wB,{keyValue:v.formatMessage({id:"UCQwvo",defaultMessage:"Registered prompts"}),value:(0,f.Y)(Ae,{tags:n,runUuid:e})})]});return[{id:Xe.DETAILS,title:v.formatMessage({id:"QGiy9C",defaultMessage:"About this run"}),content:I},{id:Xe.DATASETS,title:v.formatMessage({id:"yrsFOP",defaultMessage:"Datasets"}),content:null!==s&&void 0!==s&&s.length?(0,f.Y)(Qe,{tags:n,runInfo:t,datasets:s}):(0,f.Y)($e.bw,{})},{id:Xe.TAGS,title:v.formatMessage({id:"arFT1W",defaultMessage:"Tags"}),content:(0,f.Y)(ge,{runUuid:null!==(h=t.runUuid)&&void 0!==h?h:"",tags:n,onTagsUpdated:o})},{id:Xe.REGISTERED_MODELS,title:v.formatMessage({id:"HnGOwk",defaultMessage:"Registered models"}),content:(null===u||void 0===u?void 0:u.length)>0?(0,f.Y)(ye,{registeredModelVersionSummaries:u}):(0,f.Y)($e.bw,{})}]})({runUuid:e,runInfo:o,tags:n,onTagsUpdated:t,datasets:s,loggedModelsV3:v,shouldRenderLoggedModelsBox:S,registeredModelVersionSummaries:R}),D=!0;return(0,f.FD)(Ke.a,{css:Je,usingSidebarLayout:D,secondarySections:C,children:[(0,f.Y)(ve,{runUuid:e,tags:n,onDescriptionChanged:t}),!1,(0,f.FD)("div",{css:[{flexDirection:"column"},{display:"flex",gap:_.spacing.lg,overflow:"hidden"},""],children:[(0,f.Y)(te,{latestMetrics:l,runInfo:o,loggedModels:v}),(0,f.Y)(V.y,{params:a})]}),T&&(0,f.FD)(f.FK,{children:[!1,(0,f.Y)("div",{css:Ze,children:(0,f.Y)(Ve,{loggedModelsV3:v,isLoadingLoggedModels:y,inputs:u,outputs:p,runInfo:o,loggedModelsError:Y})})]}),!1,(0,f.Y)("div",{css:et})]})};var nt=n(19816),rt=n(77153),ot=n(42110);function it({runId:e}){return(0,f.Y)(ot.E,{statusCode:404,subMessage:`Run ID ${e} does not exist`,fallbackHomePageReactRoute:x.Ay.rootRoute})}var st=n(24523),at=n(30383),lt=n(44484),dt=n(94721),ut=n(35286),ct=n(18756);const mt=({contextData:{metricsForRun:e},hoverData:t,chartData:{metricKey:n},isHovering:r,mode:o})=>{var s;const a=(0,ut.bL)(t)?t.hoveredDataPoint:t,l=(0,U.A)();if(o===ut.QS.MultipleTracesWithScanline&&(0,ut.bL)(t)&&r)return(0,f.Y)(ct.G,{hoverData:t});if(null===a||void 0===a||!a.metricEntity)return null;const{timestamp:d,step:u,value:c}=a.metricEntity,g=(null===e||void 0===e||null===(s=e[n])||void 0===s?void 0:s.length)>1,p=(0,$.bw)(n),h=g&&p&&!(0,b.isUndefined)(d),v=g&&!p&&!(0,b.isUndefined)(u);return(0,f.FD)("div",{children:[v&&(0,f.FD)("div",{css:gt.valueField,children:[(0,f.FD)("strong",{children:[(0,f.Y)(Y.A,{id:"a02Pn6",defaultMessage:"Step"}),":"]})," ",u]}),h&&(0,f.FD)("div",{css:gt.valueField,children:[(0,f.FD)("strong",{children:[(0,f.Y)(Y.A,{id:"faLIN+",defaultMessage:"Timestamp"}),":"]})," ",m.A.formatTimestamp(d,l)]}),c&&(0,f.FD)("div",{children:[(0,f.Y)(i.T.Text,{bold:!0,children:n}),(0,f.Y)(N.S,{size:"xs"}),(0,f.Y)(i.T.Text,{children:c})]})]})},gt={valueField:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}};var pt=n(86133),ht=n(53274),vt=n(51120),ft=n(55600),yt=n(95379),Yt=n(58355),Mt=n(57864),xt=n(61293),_t=n(47946),It=n(67901),At=n(29757),bt=n(6564);var Tt={name:"xt6tct",styles:"flex:1;display:flex;flex-direction:column;overflow:hidden"},St={name:"1tc6xju",styles:"flex:1;overflow:auto"};const wt=({runInfo:e,metricKeys:t,mode:n,chartUIState:a,updateChartsUIState:l,latestMetrics:u={},params:c={},tags:m={}})=>{var p;const{theme:h}=(0,i.u)(),[v,y]=(0,d.useState)(""),{formatMessage:Y}=(0,U.A)(),{compareRunCharts:M,compareRunSections:x,chartsSearchFilter:_}=a,I=(0,d.useMemo)((()=>{var e;return null!==(e=null===M||void 0===M?void 0:M.filter((e=>!e.deleted)))&&void 0!==e?e:[]}),[M]),[A,T]=(0,d.useState)(void 0),S=(0,s.d4)((({entities:t})=>{var n;return(0,b.mapValues)(t.sampledMetricsByRunUuid[null!==(n=e.runUuid)&&void 0!==n?n:""],(e=>(0,b.compact)((0,b.values)(e).map((({metricsHistory:e})=>e)).flat())))})),w=(0,d.useMemo)((()=>({runInfo:e,metricsForRun:S})),[e,S]),{imagesByRunUuid:R}=(0,s.d4)((e=>({imagesByRunUuid:e.entities.imagesByRunUuid}))),[C,D]=(0,d.useState)(null),E=(0,yt.iO)(),k=(0,yt.cA)(),F=(0,yt.KP)(),L=(0,yt.Ez)(),N=(0,d.useMemo)((()=>{var t,n,r;return[{displayName:null!==(t=e.runName)&&void 0!==t?t:"",metrics:u,params:c,tags:m,images:R[null!==(n=e.runUuid)&&void 0!==n?n:""]||{},metricHistory:{},uuid:null!==(r=e.runUuid)&&void 0!==r?r:"",color:h.colors.primary,runInfo:e}]}),[e,u,c,m,R,h]);(0,d.useEffect)((()=>{if((!x||!M)&&N.length>0){const{resultChartSet:e,resultSectionSet:t}=pt.i$.getBaseChartAndSectionConfigs({runsData:N,enabledSectionNames:["model"===n?g.NN:g.rx],filterMetricNames:e=>{const t=e.startsWith(g.qt);return"model"===n?!t:t}});l((n=>({...n,compareRunCharts:e,compareRunSections:t})))}}),[M,x,N,n,l]),(0,d.useEffect)((()=>{l((e=>{if(!e.compareRunCharts||!e.compareRunSections)return e;const{resultChartSet:t,resultSectionSet:r,isResultUpdated:o}=pt.i$.updateChartAndSectionConfigs({compareRunCharts:e.compareRunCharts,compareRunSections:e.compareRunSections,runsData:N,isAccordionReordered:e.isAccordionReordered,filterMetricNames:e=>{const t=e.startsWith(g.qt);return"model"===n?!t:t}});return o?{...e,compareRunCharts:t,compareRunSections:r}:e}))}),[N,l,n]);const P=(0,xt.$)(),B=a.autoRefreshEnabled&&(0,ie.vC)()&&P,O=Boolean(m[g.Cr]);return(0,_t.L)({runUuids:[null!==(p=e.runUuid)&&void 0!==p?p:""],runUuidsIsActive:["RUNNING"===e.status],autoRefreshEnabled:B,enabled:O}),(0,f.FD)("div",{css:Tt,children:[(0,f.FD)("div",{css:(0,r.AH)({paddingBottom:h.spacing.md,display:"flex",gap:h.spacing.sm,flex:"0 0 auto"},""),children:[(0,f.Y)(bt.I,{chartsSearchFilter:_}),(0,ie.vC)()&&(0,f.Y)(o.ToggleButton,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_run-page_runviewmetricchartsv2.tsx_244",pressed:a.autoRefreshEnabled,onPressedChange:e=>{l((t=>({...t,autoRefreshEnabled:e})))},children:Y({id:"zC/uKl",defaultMessage:"Auto-refresh"})}),(0,f.Y)(It.f,{metricKeyList:t,globalLineChartConfig:a.globalLineChartConfig,updateUIState:l})]}),(0,f.Y)("div",{css:St,children:(0,f.Y)(ut.W,{contextData:w,component:mt,children:(0,f.Y)(At.c_,{visibleChartCards:I,children:(0,f.Y)(vt.J,{compareRunSections:x,compareRunCharts:I,reorderCharts:E,insertCharts:k,chartData:N,startEditChart:e=>D(e),removeChart:F,addNewChartCard:e=>t=>D(pt.i$.getEmptyChartCardByType(t,!1,void 0,e)),search:null!==_&&void 0!==_?_:"",supportedChartTypes:[pt.zL.LINE,pt.zL.BAR,pt.zL.IMAGE],setFullScreenChart:T,autoRefreshEnabled:B,globalLineChartConfig:a.globalLineChartConfig,groupBy:null})})})}),C&&(0,f.Y)(ft.z,{chartRunData:N,metricKeyList:t,paramKeyList:[],config:C,onSubmit:e=>{L(e),D(null)},onCancel:()=>D(null),groupBy:null,supportedChartTypes:[pt.zL.LINE,pt.zL.BAR,pt.zL.IMAGE],globalLineChartConfig:a.globalLineChartConfig}),(0,f.Y)(Mt._,{fullScreenChart:A,onCancel:()=>T(void 0),chartData:N,tooltipContextValue:w,tooltipComponent:mt,autoRefreshEnabled:B,groupBy:null})]})},Rt=e=>{const t=`${e.runInfo.runUuid}-${e.mode}`,n=(0,d.useMemo)((()=>Yt.A.getStoreForComponent("RunPage",t)),[t]),[r,o]=(0,d.useState)((()=>{const e={isAccordionReordered:!1,compareRunCharts:void 0,compareRunSections:void 0,autoRefreshEnabled:(0,ie.vC)(),globalLineChartConfig:{xAxisKey:ht.fj.STEP,lineSmoothness:0,selectedXAxisMetricKey:""}};try{const t=n.getItem("chartUIState");return t?JSON.parse(t):e}catch{return e}}));return(0,d.useEffect)((()=>{n.setItem("chartUIState",JSON.stringify(r))}),[r,n]),(0,f.Y)(yt.oB,{updateChartsUIState:o,children:(0,f.Y)(wt,{...e,chartUIState:r,updateChartsUIState:o})})};var Ct=n(18705),Dt=n(92550);var Et=n(79196);const kt=()=>(0,f.FD)(u.L,{children:[(0,f.Y)(o.TitleSkeleton,{loading:!0,label:(0,f.Y)(Y.A,{id:"ea5zBl",defaultMessage:"Run page loading"})}),[...Array(3).keys()].map((e=>(0,f.Y)(o.ParagraphSkeleton,{seed:`s-${e}`},e)))]}),Ft=()=>{var e,t;const{runUuid:n,experimentId:a}=(0,c.g)(),h=(0,c.Zp)(),{theme:M}=(0,i.u)(),[I,A]=(0,d.useState)(!1),[T,S]=(0,d.useState)(!1);l()(n,"[RunPage] Run UUID route param not provided"),l()(a,"[RunPage] Experiment ID route param not provided");const w=n,R=a,{experiment:C,error:D,latestMetrics:E,loading:F,params:U,refetchRun:N,runInfo:P,tags:B,experimentFetchError:O,runFetchError:H,apiError:V,datasets:z,runInputs:K,runOutputs:G,registeredModelVersionSummaries:q}=(0,nt.g)({experimentId:R,runUuid:w}),W=Boolean(P),[j,Q]=(0,d.useMemo)((()=>E?[Object.keys(E).filter((e=>!(0,$.bw)(e))),Object.keys(E).filter((e=>(0,$.bw)(e)))]:[[],[]]),[E]),{comparedExperimentIds:X=[],hasComparedExperimentsBefore:J=!1}=(0,s.d4)((e=>e.comparedExperiments||{})),Z=_(),ee=(0,ie.ht)(),te=((e,t,n,r,o=!0)=>{const i=(0,d.useMemo)((()=>{var e,t;const o=[...null!==(e=null===n||void 0===n?void 0:n.modelInputs)&&void 0!==e?e:[],...null!==(t=null===r||void 0===r?void 0:r.modelOutputs)&&void 0!==t?t:[]],i=(0,b.uniq)((0,b.compact)(o.map((({modelId:e})=>e))));if(!(0,b.isEmpty)(i))return`attributes.model_id IN (${i.map((e=>`'${e}'`)).join(",")})`}),[n,r]),s=o&&Boolean(i),{data:a,isLoading:l,error:u}=(0,Dt.e)({experimentIds:[e],searchQuery:i},{enabled:s});return{models:s?a:void 0,isLoading:s&&l,error:u}})(R,0,K,G,!ee),ne=(({runInputs:e,runOutputs:t,enabled:n=!0})=>{const r=(0,d.useMemo)((()=>{var n,r;const o=[...null!==(n=null===e||void 0===e?void 0:e.modelInputs)&&void 0!==n?n:[],...null!==(r=null===t||void 0===t?void 0:t.modelOutputs)&&void 0!==r?r:[]],i=(0,b.uniq)((0,b.compact)(o.map((({modelId:e})=>e))));if(!(0,b.isEmpty)(i))return i}),[e,t]),o=n&&!(0,b.isEmpty)(r),{data:i,isLoading:s,error:a}=(0,Et.o)({modelIds:r},{enabled:o});return{models:i,isLoading:o&&s,error:a}})({runInputs:K,runOutputs:G,enabled:ee}),{error:re,isLoading:oe,models:se}=ee?ne:te,ae=(0,v.Ub)(`(min-width: ${M.responsive.breakpoints.sm}px)`),le=F&&(!P||!C);return H instanceof rt.s&&H.getErrorCode()===st.tG.RESOURCE_DOES_NOT_EXIST||(null===V||void 0===V?void 0:V.code)===st.tG.RESOURCE_DOES_NOT_EXIST||D&&(0,Ct.b)(D).match(/not found$/)?(0,f.Y)(it,{runId:w}):O instanceof rt.s&&O.getErrorCode()===st.tG.RESOURCE_DOES_NOT_EXIST?(0,f.Y)(at.A,{}):H||O?null:(0,ie.wD)()&&(D||V)&&!W?(0,f.Y)("div",{css:(0,r.AH)({marginTop:M.spacing.lg},""),children:(0,f.Y)(o.Empty,{title:(0,f.Y)(Y.A,{id:"XaC3qF",defaultMessage:"Can't load run details"}),description:(0,Ct.b)(null!==V&&void 0!==V?V:D),image:(0,f.Y)(i.k,{})})}):!le&&P&&C?(0,f.FD)(f.FK,{children:[(0,f.FD)(u.L,{usesFullHeight:ae,children:[(0,f.Y)(L,{comparedExperimentIds:X,experiment:C,handleRenameRunClick:()=>A(!0),handleDeleteRunClick:()=>S(!0),hasComparedExperimentsBefore:J,runDisplayName:m.A.getRunDisplayName(P,w),runTags:B,runParams:U,runUuid:w,runOutputs:G,artifactRootUri:null!==(e=null===P||void 0===P?void 0:P.artifactUri)&&void 0!==e?e:void 0,registeredModelVersionSummaries:q,isLoading:F||oe}),(0,f.Y)("div",{css:(0,r.AH)({flex:1,overflow:"auto",marginBottom:M.spacing.sm,display:"flex"},""),children:(()=>{var e;if(!P)return null;const t=()=>(0,f.Y)(lt.r,{runUuid:w,runTags:B,experimentId:R,runDisplayName:m.A.getRunDisplayName(P,w)});switch(Z){case g.N3.MODEL_METRIC_CHARTS:return(0,f.Y)(Rt,{mode:"model",metricKeys:j,runInfo:P,latestMetrics:E,tags:B,params:U},"model");case g.N3.SYSTEM_METRIC_CHARTS:return(0,f.Y)(Rt,{mode:"system",metricKeys:Q,runInfo:P,latestMetrics:E,tags:B,params:U},"system");case g.N3.EVALUATIONS:return t();case g.N3.ARTIFACTS:return(0,f.Y)(y,{runUuid:w,runTags:B,runOutputs:G,experimentId:R,artifactUri:null!==(e=P.artifactUri)&&void 0!==e?e:void 0});case g.N3.TRACES:return t()}return(0,f.Y)(tt,{runInfo:P,tags:B,params:U,latestMetrics:E,runUuid:w,onRunDataUpdated:N,runInputs:K,runOutputs:G,datasets:z,registeredModelVersionSummaries:q,loggedModelsV3:se,isLoadingLoggedModels:oe,loggedModelsError:null!==re&&void 0!==re?re:void 0,experimentKind:(0,k.BH)(null===C||void 0===C?void 0:C.tags)})})()})]}),(0,f.Y)(p.j,{runUuid:w,onClose:()=>A(!1),runName:null!==(t=P.runName)&&void 0!==t?t:"",isOpen:I,onSuccess:N}),(0,f.Y)(dt.A,{selectedRunIds:[w],onClose:()=>S(!1),isOpen:T,onSuccess:()=>{h(x.Ay.getExperimentPageRoute(R))}})]}):(0,f.Y)(kt,{})};var Lt=Ft},14466:function(e,t,n){n.d(t,{P:function(){return d},m:function(){return a}});var r=n(46709),o=n(74060),i=n(66916),s=n(73408);const a="newName";class l extends r.Component{constructor(...e){super(...e),this.inputToAutoFocus=void 0,this.autoFocusInputRef=e=>{this.inputToAutoFocus=e,e&&e.focus(),e&&e.select()},this.autoFocus=e=>{!1===e.visible&&!0===this.props.visible&&(this.inputToAutoFocus&&this.inputToAutoFocus.focus(),this.inputToAutoFocus&&this.inputToAutoFocus.select())},this.resetFields=e=>{const t=this.props.innerRef;e.name!==this.props.name&&t.current.resetFields([a])}}componentDidUpdate(e){this.autoFocus(e),this.resetFields(e)}render(){return(0,s.Y)(o.LegacyForm,{ref:this.props.innerRef,layout:"vertical",children:(0,s.Y)(o.LegacyForm.Item,{name:a,initialValue:this.props.name,rules:[{required:!0,message:`Please input a new name for the ${this.props.type}.`},{validator:this.props.validator}],label:`New ${this.props.type} name`,children:(0,s.Y)(i.I,{componentId:"codegen_mlflow_app_src_experiment-tracking_components_modals_renameform.tsx_69",placeholder:`Input a ${this.props.type} name`,ref:this.autoFocusInputRef,"data-testid":"rename-modal-input"})})})}}const d=l},18705:function(e,t,n){n.d(t,{b:function(){return o}});var r=n(34794);const o=e=>{if(e)return e instanceof r.K4&&e.graphQLErrors.length>0?e.graphQLErrors.map((e=>e.message||e.toString())).join(", "):"message"in e?e.message:e.toString()}},24712:function(e,t,n){n.d(t,{S:function(){return Y}});var r=n(68248),o=n(46709),i=n(884),s=n(27757),a=n(79081),l=n(74060),d=n(40724),u=n(85786),c=n(7655),m=n(73408);const g="value",p=({form:e,name:t,initialTags:n})=>{const r=(0,c.A)(),o=(0,u.$W)({name:t,emptyValue:{key:"",value:""},keyProperty:"key",valueProperty:g,form:e,defaultValues:n});return(0,m.FD)(u.Es,{...o,children:[(0,m.FD)(u.qd,{children:[(0,m.Y)(u.C2,{children:(0,m.Y)(d.A,{id:"h2SXjO",defaultMessage:"Key"})}),(0,m.Y)(u.C2,{children:(0,m.Y)(d.A,{id:"6yjymQ",defaultMessage:"Value"})})]}),o.fields.map(((e,t)=>(0,m.FD)(u.qd,{children:[(0,m.Y)(u.R0,{index:t,rules:{validate:{unique:e=>{const n=o.getTagsValues();return(null===n||void 0===n?void 0:n.findIndex((t=>t.key===e)))===t||r.formatMessage({id:"sLBHQp",defaultMessage:"Key must be unique"})},required:e=>{var n;const i=o.getTagsValues();return!(null!==i&&void 0!==i&&null!==(n=i.at(t))&&void 0!==n&&n[g]&&!e)||r.formatMessage({id:"J45Atg",defaultMessage:"Key is required if value is present"})}}}}),(0,m.Y)(u.tP,{index:t}),(0,m.Y)(u.ki,{index:t,componentId:"endpoint-tags-section.remove-button"})]},e.id)))]})},h="key",v="value",f="tags",y={key:"",value:""},Y=({componentIdPrefix:e,title:t,visible:n,initialTags:u,isLoading:c=!1,error:g,onSubmit:Y,onSuccess:M,onClose:x})=>{const _=`${e}.tag-assignment-modal`,[I,A]=(0,o.useState)(!1),{theme:b}=(0,s.u)(),T=(0,i.mN)({mode:"onChange"}),S=()=>{A(!1),T.reset({[f]:[y]}),null===x||void 0===x||x()},w=(0,m.Y)(d.A,{id:"AGWpnl",defaultMessage:"Add tags"});return{TagAssignmentModal:(0,m.FD)(a.d,{componentId:`${_}`,title:null!==t&&void 0!==t?t:w,visible:null!==n&&void 0!==n?n:I,destroyOnClose:!0,onCancel:S,footer:(0,m.FD)(m.FK,{children:[(0,m.Y)(s.B,{componentId:`${_}.submit-button`,onClick:S,disabled:c,children:(0,m.Y)(d.A,{id:"awekbG",defaultMessage:"Cancel"})}),(0,m.Y)(s.B,{componentId:`${_}.submit-button`,type:"primary",onClick:T.handleSubmit((e=>{var t,n;const r=e[f].filter((e=>Boolean(e[h]))),o=null!==(t=r.filter((e=>!(null!==u&&void 0!==u&&u.some((t=>t[h]===e[h]&&t[v]===e[v]))))))&&void 0!==t?t:[],i=null!==(n=null===u||void 0===u?void 0:u.filter((e=>!r.some((t=>t[h]===e[h]&&t[v]===e[v])))))&&void 0!==n?n:[];Y(o,i).then((()=>{S(),null===M||void 0===M||M()}))})),loading:c,disabled:c,children:(0,m.Y)(d.A,{id:"C6ReUY",defaultMessage:"Save"})})]}),children:[g&&(0,m.Y)(l.Alert,{type:"error",message:g,componentId:`${_}.error`,closable:!1,css:(0,r.AH)({marginBottom:b.spacing.sm},"")}),(0,m.Y)(p,{name:f,form:T,initialTags:u})]}),showTagAssignmentModal:()=>{A(!0)},hideTagAssignmentModal:S}}},30383:function(e,t,n){var r=n(46709),o=n(73408);class i extends r.Component{render(){return(0,o.Y)("div",{children:"Resource not found."})}}t.A=i},54401:function(e,t,n){n.d(t,{L:function(){return s}});n(46709);var r=n(74060),o=n(79081),i=n(73408);function s(e){const{usesFullHeight:t,...n}=e;return(0,i.FD)(r.PageWrapper,{css:t?a.useFullHeightLayout:a.wrapper,children:[(0,i.Y)(o.S,{css:a.fixedSpacer}),t?e.children:(0,i.Y)("div",{...n,css:a.container})]})}s.defaultProps={usesFullHeight:!1};const a={useFullHeightLayout:{height:"100%",display:"flex",flexDirection:"column","&:last-child":{flexGrow:1}},wrapper:{flex:1},fixedSpacer:{flexShrink:0},container:{width:"100%",flexGrow:1,paddingBottom:24}}}}]);