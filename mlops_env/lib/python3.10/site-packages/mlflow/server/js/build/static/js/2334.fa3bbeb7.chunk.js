"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[2334],{16333:function(t,n,e){e.d(n,{Ld:function(){return i.L},ad:function(){return r.a}});e(37750);var r=e(44072),i=e(38815)},21636:function(t,n,e){e.d(n,{Bt:function(){return i},Ex:function(){return o},Uu:function(){return l},Vg:function(){return u},gK:function(){return s},kj:function(){return r},n2:function(){return c},zZ:function(){return a}});const r="yellow500",i="yellow200",o="mlflow.trace.sourceScorer",u="mlflow.assessment.sourceRunId",s="mlflow.assessment.scorerTraceId",a="mlflow.assessment.judgeCost",c="mlflow.trace.session",l="mlflow.trace.tokenUsage"},30676:function(t,n,e){e.d(n,{z7:function(){return R},VE:function(){return E}});var r=e(76386),i=e(91215),o=e(49693),u=e(94066),s=e(3491),a=e(20515),c=e(27962),l=e(54921),d=e(94811),f=e(52394),p=e(76118),v=e(73408),m=(e(46709),e(16333)),y=e(74060),N=e(27757);var g={name:"1739oy8",styles:"z-index:1"};function h({tooltipMessage:t,...n}){const e=g;return(0,v.Y)(y.LegacyTooltip,{title:t,children:(0,v.Y)(N.B,{componentId:"codegen_web-shared_src_snippet_actions_snippetactionbutton.tsx_33",...n,css:e})})}function E({copyText:t,onClick:n,...e}){const{actionIcon:r,tooltipMessage:i,copy:o}=(0,m.Ld)(t);return(0,v.Y)(h,{tooltipMessage:i,icon:r,onClick:t=>{o(),null===n||void 0===n||n(t)},...e})}r.A.registerLanguage("sql",l.A),r.A.registerLanguage("java",o.A),r.A.registerLanguage("python",a.A),r.A.registerLanguage("go",i.A),r.A.registerLanguage("javascript",u.A),r.A.registerLanguage("yaml",c.A),r.A.registerLanguage("json",s.A);const _="24px",A={light:f.A,duotoneDark:d.A};function R({theme:t="light",language:n,actions:e,style:i,children:o,showLineNumbers:u,lineNumberStyle:s,wrapLongLines:a,wrapLines:c,lineProps:l,PreTag:d}){const f={border:"none",borderRadius:0,margin:0,padding:_,...i};return(0,v.Y)(r.A,{showLineNumbers:u,lineNumberStyle:s,language:n,style:A[t],customStyle:f,codeTagProps:{style:(0,p.pick)(i,"backgroundColor")},lineProps:l,wrapLongLines:a,wrapLines:c,PreTag:d,children:o})}},42747:function(t,n,e){e.d(n,{sA:function(){return r.sA},tz:function(){return r.tz},zR:function(){return r.zR}});var r=e(77680);e(13584)},44072:function(t,n,e){e.d(n,{a:function(){return s}});e(46709);var r=e(27757),i=e(79081),o=e(38815),u=e(73408);function s({buttonProps:t,componentId:n,copyText:e,copyTooltip:s,isInsideInputGroup:a=!1,onCopy:c,tooltipProps:l}){const{actionIcon:d,copy:f,handleTooltipOpenChange:p,tooltipOpen:v,tooltipMessage:m}=(0,o.L)(e,s,c),y=(0,u.Y)(r.B,{"aria-label":m,componentId:null!==n&&void 0!==n?n:"codegen_web-shared_src_copy_copyactionbutton.tsx_17",icon:d,onClick:f,size:"small",...t}),N=(0,u.Y)(r.B,{"aria-label":m,componentId:null!==n&&void 0!==n?n:"codegen_web-shared_src_copy_copyactionbutton.tsx_17",onClick:f,...t,children:d});return(0,u.Y)(i.T,{componentId:n?`${n}-tooltip`:"codegen_web-shared_src_copy_copyactionbutton.tsx_17-tooltip",content:m,onOpenChange:p,open:v,...l,children:a?N:y})}},86125:function(t,n,e){e.d(n,{BS:function(){return l},CL:function(){return V},Hq:function(){return F},I$:function(){return B},LS:function(){return p},MF:function(){return T},N7:function(){return x},OS:function(){return I},PC:function(){return K},Q0:function(){return D},UZ:function(){return _},W0:function(){return U},ZI:function(){return $},bn:function(){return G},cp:function(){return R},f7:function(){return N},gD:function(){return E},g_:function(){return S},h8:function(){return P},ij:function(){return d},in:function(){return j},jW:function(){return w},nr:function(){return q},ob:function(){return L},pQ:function(){return z},tC:function(){return f},tI:function(){return Z},vL:function(){return y},vl:function(){return k},x0:function(){return Y},xD:function(){return v}});var r=e(68248),i=e(76118),o=(e(46709),e(94664)),u=e(51847),s=e(66016),a=(e(81390),e(21636)),c=e(73408);const l="model-trace-info-v3",d=t=>{};function f(t){switch(t){case o.UG.LLM:return o.Dy.MODELS;case o.UG.CHAIN:return o.Dy.CHAIN;case o.UG.AGENT:return o.Dy.AGENT;case o.UG.TOOL:return o.Dy.WRENCH;case o.UG.CHAT_MODEL:return o.Dy.MODELS;case o.UG.RETRIEVER:return o.Dy.SEARCH;case o.UG.PARSER:return o.Dy.CODE;case o.UG.EMBEDDING:return o.Dy.NUMBERS;case o.UG.RERANKER:return o.Dy.SORT;case o.UG.MEMORY:return o.Dy.SAVE;case o.UG.FUNCTION:return o.Dy.FUNCTION;case o.UG.UNKNOWN:return o.Dy.UNKNOWN;default:return o.Dy.FUNCTION}}function p(t){switch(t){case o.UG.LLM:return"LLM";case o.UG.CHAIN:return"Chain";case o.UG.AGENT:return"Agent";case o.UG.TOOL:return"Tool";case o.UG.CHAT_MODEL:return"Chat model";case o.UG.RETRIEVER:return"Retriever";case o.UG.PARSER:return"Parser";case o.UG.EMBEDDING:return"Embedding";case o.UG.RERANKER:return"Reranker";case o.UG.MEMORY:return"Memory";case o.UG.FUNCTION:return"Function";case o.UG.UNKNOWN:return"Unknown";default:return t}}function v(t){try{return JSON.parse(t)}catch(n){return t}}const m=(t,n)=>{if(!n)return[];const e=[],r={inputs:null===t||void 0===t?void 0:t.inputs,outputs:null===t||void 0===t?void 0:t.outputs,attributes:null===t||void 0===t?void 0:t.attributes,events:null===t||void 0===t?void 0:t.events};return(0,i.map)(r,((r,i)=>{if("events"===i)return void e.push(...((t,n)=>{const e=t.events;if(!e)return[];const r=[];return e.forEach(((e,i)=>{const o=e.attributes;o&&Object.keys(o).forEach((u=>{const s=u.toLowerCase().includes(n),a=D(e.name,i,u);s&&r.push({span:t,section:"events",key:a,isKeyMatch:!0,matchIndex:0});const c=JSON.stringify(o[u]).toLowerCase().split(n).length-1;for(let n=0;n<c;n++)r.push({span:t,section:"events",key:a,isKeyMatch:!1,matchIndex:n})}))})),r})(t,n));S(r).forEach((r=>{r.key.toLowerCase().includes(n)&&e.push({span:t,section:i,key:r.key,isKeyMatch:!0,matchIndex:0});const o=r.value.toLowerCase().split(n).length-1;for(let n=0;n<o;n++)e.push({span:t,section:i,key:r.key,isKeyMatch:!1,matchIndex:n})}))})),e};function y(t,n,e){var r,i;const o=n.toLowerCase().trim(),u=Object.values(e.spanTypeDisplayState).every((t=>t));if(""===o&&u)return{filteredTreeNodes:[t],matches:[]};const s=null!==(r=t.children)&&void 0!==r?r:[],a=[],c=[];s.forEach((t=>{const{filteredTreeNodes:n,matches:r}=y(t,o,e);a.push(...n),c.push(...r)}));const l=(null!==(i=t.title)&&void 0!==i?i:"").toLowerCase(),d=m(t,o),f=d.length>0||l.includes(o),p=!t.type||e.spanTypeDisplayState[t.type],v=f&&p,N=a.length>0,g=x(t)>0;return v||e.showParents&&N||e.showExceptions&&g?{filteredTreeNodes:[{...t,children:a}],matches:d.concat(c)}:{filteredTreeNodes:a,matches:c}}function N(t,n){var e;if((0,i.isNil)(n)||(0,i.isNil)(t))return;if(t.key===n)return t;const r=null!==(e=t.children)&&void 0!==e?e:[];for(const i of r){const t=N(i,n);if(t)return t}}const g=(t,n,e,r,o,s)=>{var a,l,d,p,m,y,N,g;const h=v(null===(a=t.attributes)||void 0===a?void 0:a["mlflow.spanType"]),E=v(null===(l=t.attributes)||void 0===l?void 0:l["mlflow.spanInputs"]),_=v(null===(d=t.attributes)||void 0===d?void 0:d["mlflow.spanOutputs"]),T=R(t),L=A(t),w=null!==(p=o[L])&&void 0!==p?p:[];var C;T||w.push(...null!==(C=o[""])&&void 0!==C?C:[]);const M=v(null===(m=t.attributes)||void 0===m?void 0:m["mlflow.chat.messages"]),S=v(null===(y=t.attributes)||void 0===y?void 0:y["mlflow.message.format"]),I=((t,n,e,r)=>{var o,u;if(Array.isArray(t)&&t.every(B))return(0,i.compact)(t.map($));const s=null!==(o=F(n,r))&&void 0!==o?o:[],a=null!==(u=F(e,r))&&void 0!==u?u:[];return 0!==s.length&&0!==a.length?s.concat(a):void 0})(M,E,_,S),U=((t,n)=>{var e;return Array.isArray(t)&&t.every(K)?t:Array.isArray(null===n||void 0===n?void 0:n.tools)&&null!==n&&void 0!==n&&null!==(e=n.tools)&&void 0!==e&&e.every(K)?n.tools:void 0})(v(null===(N=t.attributes)||void 0===N?void 0:N["mlflow.chat.tools"]),E),k=(0,i.mapValues)((0,i.omitBy)(t.attributes,((t,n)=>n.startsWith("mlflow."))),(t=>v(t))),D=t.events,G=(Number(b(t))-n)/1e3,H=(Number(null!==(g=O(t))&&void 0!==g?g:e)-n)/1e3;return{title:t.name,icon:(0,c.Y)(u.P,{type:f(h),hasException:x(t)>0,isRootSpan:!T}),type:h,key:L,start:G,end:H,children:r,inputs:E,outputs:_,attributes:k,events:D,chatMessageFormat:S,chatMessages:I,chatTools:U,parentId:T,assessments:w,traceId:s}},h=(t,n)=>{if(!t)return"";if(n&&t.length<16)try{return(t=>{const n=atob(t),e=n.length;let r="";for(let i=0;i<e;i++)r+=n.charCodeAt(i).toString(16).padStart(2,"0");return r})(t)}catch(e){return t}return t.startsWith("0x")?t.slice(2):t};function E(t){return"trace_location"in t}function _(t){return"start_time_unix_nano"in t}function A(t){var n,e,r;return _(t)?h(null!==(n=t.span_id)&&void 0!==n?n:"",!0):h(null!==(e=null===(r=t.context)||void 0===r?void 0:r.span_id)&&void 0!==e?e:"",!1)}function R(t){var n,e;return _(t)?h(null!==(n=t.parent_span_id)&&void 0!==n?n:"",!0):h(null!==(e=t.parent_id)&&void 0!==e?e:"",!1)}function b(t){return _(t)?Number(t.start_time_unix_nano):Number(t.start_time)}function O(t){return _(t)?Number(t.end_time_unix_nano):Number(t.end_time)}function T(t){var n;return E(t.info)?t.info.trace_id:null!==(n=t.info.request_id)&&void 0!==n?n:""}function L(t){var n,e;if(!E(t.info))return null;const r=Number(null===(n=t.info)||void 0===n||null===(e=n.trace_metadata)||void 0===e?void 0:e["mlflow.trace.sizeBytes"]);return(0,i.isNil)(r)||isNaN(r)?null:r}function w(t){var n,e;const r=T(t),s=null!==(n=null===(e=t.trace_data)||void 0===e?void 0:e.spans)&&void 0!==n?n:t.data.spans,a={},l={};s.forEach((t=>{const n=A(t);a[n]=t,l[n]=[]})),s.forEach((t=>{const n=A(t),e=R(t);if(e){if(!l[e])throw new Error("Tree structure is malformed!");l[e].push(n)}}));const d=s.find((t=>!R(t)));if((0,i.isNil)(d))return null;return function n(e){var i,s,p;const v=a[e],m=Number(b(d)),y=Number(O(d)),N=l[e].map(n),h=C(t.info);if(_(v)||"parent_id"in v)return g(v,m,y,N,h,r);const E=null!==(i=v.span_type)&&void 0!==i?i:o.UG.UNKNOWN;return{title:v.name,icon:(0,c.Y)(u.P,{type:f(E)}),type:E,key:v.context.span_id,start:Number(v.start_time)-m,end:Number(null!==(s=v.end_time)&&void 0!==s?s:y)-m,children:N,inputs:v.inputs,outputs:v.outputs,attributes:v.attributes,events:v.events,parentId:null!==(p=v.parent_id)&&void 0!==p?p:v.parent_span_id,assessments:[],traceId:r}}(A(d))}const C=t=>{let n=[];var e;E(t)?n=null!==(e=t.assessments)&&void 0!==e?e:[]:n=M(t.tags);const r=(0,i.keyBy)(n,"assessment_id");Object.values(r).forEach((t=>{if(t.overrides){const n=r[t.overrides];t.overriddenAssessment=n}})),n=Object.values(r);const o=n.reduce(((t,n)=>{var e;const r=null!==(e=n.span_id)&&void 0!==e?e:"";return t[r]||(t[r]=[]),t[r].push(n),t}),{});return Object.keys(o).forEach((t=>{o[t].sort(((t,n)=>new Date(n.last_update_time).getTime()-new Date(t.last_update_time).getTime()))})),o},M=t=>{if(!t)return[];return(Array.isArray(t)?t:Object.entries(t).map((([t,n])=>({key:t,value:n})))).filter((({key:t})=>t.startsWith("mlflow.assessment."))).map((({value:t})=>JSON.parse(t)))};const S=t=>(0,i.isNil)(t)?[]:Array.isArray(t)||(0,i.isString)(t)||(0,i.isNumber)(t)||(0,i.isBoolean)(t)?[{key:"",value:JSON.stringify(t,null,2)}]:Object.entries(t).map((([t,n])=>({key:t,value:JSON.stringify(n,null,2)}))),I=({searchFilter:t,data:n,activeMatchBackgroundColor:e,inactiveMatchBackgroundColor:o,containsActiveMatch:u,activeMatch:s,scrollToActiveMatch:a})=>{const l=new RegExp(`(${(0,i.escapeRegExp)(t.trim())})`,"gi"),d=n.split(l),f=[];let p=0;for(let i=0;i<d.length;i++)if(d[i].toLowerCase().includes(t.toLowerCase().trim())){const t=u&&s.matchIndex===p,n=t?e:o,l=(0,c.Y)("span",{ref:t?a:null,css:(0,r.AH)({backgroundColor:n,scrollMarginTop:50},""),children:d[i]},i);p++,f.push(l)}else f.push(d[i]);return f},U=t=>(0,i.has)(t,"page_content"),k=t=>t.type===o.UG.RETRIEVER&&Array.isArray(t.outputs)&&t.outputs.length>0&&(0,i.every)(t.outputs,U),D=(t,n,e)=>`${t}-${n}-${e}`,G=t=>{var n;return(null!==(n=t.events)&&void 0!==n?n:[]).filter((t=>"exception"===t.name))},x=t=>G(t).length,H=t=>!(0,i.isNil)(t)&&(!(!(0,i.isNil)(t.type)&&!(0,i.isString)(t.type))&&(!(!(0,i.isNil)(t.description)&&!(0,i.isString)(t.description))&&!(!(0,i.isNil)(t.enum)&&!Array.isArray(t.enum)))),K=t=>{var n;if((0,i.isNil)(t)||"function"!==t.type||!(0,i.has)(t,"function.name"))return!1;const e=null===(n=t.function)||void 0===n?void 0:n.parameters;if(!(0,i.isNil)(e)){const t=e.required;if(!(0,i.isNil)(t)&&(!Array.isArray(t)||!t.every(i.isString)))return!1;const n=e.properties;if(!(0,i.isNil)(n)&&!Object.values(n).every(H))return!1}return!0},P=t=>{var n,e;return t&&(0,i.isString)(t.id)&&(0,i.isString)(null===(n=t.function)||void 0===n?void 0:n.arguments)&&(0,i.isString)(null===(e=t.function)||void 0===e?void 0:e.name)},W=t=>!(!(0,i.isNil)(t)&&!(0,i.isString)(t))||!!(0,i.isArray)(t)&&t.every((t=>(t=>{switch(t.type){case"text":case"input_text":case"output_text":return(0,i.isString)(t.text);case"image_url":const{image_url:n}=t;return!(0,i.isNil)(n)&&(0,i.isString)(n.url)&&((0,i.isNil)(n.detail)||["auto","low","high"].includes(n.detail));case"input_audio":const{input_audio:e}=t;return!(0,i.isNil)(e)&&(0,i.isString)(e.data)&&((0,i.isNil)(e.format)||["wav","mp3"].includes(e.format));default:return!1}})(t))),B=t=>{if(!t)return!1;if(t.tool_calls){if(!Array.isArray(t.tool_calls))return!1;if(!t.tool_calls.every(P))return!1}return(!t.parts||!(0,i.isNil)(t.content))&&("reasoning"===t.type||!!W(t.content)&&("user"===t.role||"assistant"===t.role||"system"===t.role||"tool"===t.role))},Y=t=>Array.isArray(t)&&t.length>0&&t.every((t=>{return(0,i.has)(t,"message")&&(n=t.message,!!B(n)&&((0,i.isNil)(n.content)||(0,i.isString)(n.content)));var n})),j=t=>t&&Y(t.choices),F=(t,n)=>{var e,r,o,u,a,c,l,d,f,p,v,m,y;try{if(Array.isArray(t)&&t.length>0&&t.every(B))return(0,i.compact)(t.map($));switch(n){case"langchain":const n=null!==(e=(0,s.HD)(t))&&void 0!==e?e:(0,s.oI)(t);if(n)return n;break;case"llamaindex":const i=null!==(r=(0,s.Hy)(t))&&void 0!==r?r:(0,s.W3)(t);if(i)return i;break;case"openai":const N=null!==(o=null!==(u=null!==(a=(0,s.a8)(t))&&void 0!==a?a:(0,s.bS)(t))&&void 0!==u?u:(0,s.n_)(t))&&void 0!==o?o:(0,s.AG)(t);if(N)return N;break;case"dspy":const g=null!==(c=(0,s.iU)(t))&&void 0!==c?c:(0,s.Pn)(t);if(g)return g;break;case"gemini":const h=null!==(l=(0,s.DE)(t))&&void 0!==l?l:(0,s.Sy)(t);if(h)return h;break;case"anthropic":const E=null!==(d=(0,s.KF)(t))&&void 0!==d?d:(0,s.pL)(t);if(E)return E;break;case"openai-agent":const _=null!==(f=(0,s.xW)(t))&&void 0!==f?f:(0,s.m$)(t);if(_)return _;break;case"autogen":const A=null!==(p=(0,s.nW)(t))&&void 0!==p?p:(0,s.u6)(t);if(A)return A;break;case"bedrock":const R=null!==(v=(0,s.Yv)(t))&&void 0!==v?v:(0,s.f1)(t);if(R)return R;break;case"vercel_ai":const b=null!==(m=(0,s.fJ)(t))&&void 0!==m?m:(0,s.QA)(t);if(b)return b;break;default:const O=null!==(y=(0,s.a8)(t))&&void 0!==y?y:(0,s.bS)(t);if(O)return O}return Array.isArray(t)&&t.length>0&&t.every(s.oi)?(0,i.compact)(t.map(s.pN)):null}catch(N){return null}},V=t=>{var n;let e=null===(n=t.function)||void 0===n?void 0:n.arguments;try{e=JSON.stringify(JSON.parse(e),null,2)}catch(r){}return{id:t.id,function:{arguments:e,name:t.function.name}}},J=t=>{if((0,i.isNil)(t)||(0,i.isString)(t))return t;return t.map((t=>{var n;switch(t.type){case"text":case"input_text":case"output_text":return t.text;case"image_url":const e=null===t||void 0===t||null===(n=t.image_url)||void 0===n?void 0:n.url;return e?`![](${e})`:"[image]";case"input_audio":return"[audio]"}})).filter((t=>void 0!==t)).join("\n\n")},$=t=>{var n;return"reasoning"===t.type?null:{...t,content:J(t.content),tool_calls:null===(n=t.tool_calls)||void 0===n?void 0:n.map(V)}},z=t=>{if((0,i.isNil)(t))return"content";if(t.chatMessages)return"chat";return!(0,i.isNil)(t.inputs)||!(0,i.isNil)(t.outputs)?"content":"attributes"},q=t=>{var n,e,r,i;return"MLFLOW_EXPERIMENT"===t.type?null===(n=t.mlflow_experiment)||void 0===n?void 0:n.experiment_id:"INFERENCE_TABLE"===t.type?null===(e=t.inference_table)||void 0===e?void 0:e.full_table_name:"UC_SCHEMA"===t.type?`${null===(r=t.uc_schema)||void 0===r?void 0:r.catalog_name}.${null===(i=t.uc_schema)||void 0===i?void 0:i.schema_name}`:void 0},Z=t=>{var n;const e=null===(n=t.trace_metadata)||void 0===n?void 0:n[a.Uu];if(!e)return null;try{var r;const t=JSON.parse(e);return null!==(r=null===t||void 0===t?void 0:t.total_tokens)&&void 0!==r?r:null}catch{return null}}},94664:function(t,n,e){e.d(n,{Dy:function(){return s},E3:function(){return i},Fg:function(){return r},OS:function(){return o},UG:function(){return u},VZ:function(){return a},cC:function(){return c}});const r="mlflow.trace.session",i="mlflow.trace.user",o="mlflow.trace.tokenUsage";let u=function(t){return t.LLM="LLM",t.CHAIN="CHAIN",t.AGENT="AGENT",t.TOOL="TOOL",t.FUNCTION="FUNCTION",t.CHAT_MODEL="CHAT_MODEL",t.RETRIEVER="RETRIEVER",t.PARSER="PARSER",t.EMBEDDING="EMBEDDING",t.RERANKER="RERANKER",t.MEMORY="MEMORY",t.UNKNOWN="UNKNOWN",t}({}),s=function(t){return t.MODELS="models",t.DOCUMENT="document",t.CONNECT="connect",t.SEARCH="search",t.SORT="sort",t.UNKNOWN="unknown",t.FUNCTION="function",t.CODE="code",t.NUMBERS="numbers",t.WRENCH="wrench",t.AGENT="agent",t.CHAIN="chain",t.USER="user",t.SYSTEM="system",t.SAVE="save",t}({}),a=function(t){return t.LLM="LLM",t.CHAIN="CHAIN",t.AGENT="AGENT",t.TOOL="TOOL",t.CHAT_MODEL="CHAT_MODEL",t.RETRIEVER="RETRIEVER",t.PARSER="PARSER",t.EMBEDDING="EMBEDDING",t.RERANKER="RERANKER",t.MEMORY="MEMORY",t.UNKNOWN="UNKNOWN",t}({}),c=function(t){return t.JSON="json",t.TEXT="text",t.MARKDOWN="markdown",t.PYTHON="python",t}({})}}]);